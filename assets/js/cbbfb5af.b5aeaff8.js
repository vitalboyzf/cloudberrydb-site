"use strict";(self.webpackChunkApache_Cloudberry_Incubating_website=self.webpackChunkApache_Cloudberry_Incubating_website||[]).push([[7263],{63383:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>d});var s=n(85893),r=n(11151);const a={title:"CREATE EXTERNAL TABLE"},i="CREATE EXTERNAL TABLE",o={id:"sql-stmts/create-external-table",title:"CREATE EXTERNAL TABLE",description:"Defines a new external table.",source:"@site/docs/sql-stmts/create-external-table.md",sourceDirName:"sql-stmts",slug:"/sql-stmts/create-external-table",permalink:"/docs/sql-stmts/create-external-table",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/cloudberry-site/edit/main/docs/sql-stmts/create-external-table.md",tags:[],version:"current",lastUpdatedBy:"Dianjin Wang",lastUpdatedAt:1733824616,formattedLastUpdatedAt:"Dec 10, 2024",frontMatter:{title:"CREATE EXTERNAL TABLE"},sidebar:"docsbars",previous:{title:"CREATE EXTENSION",permalink:"/docs/sql-stmts/create-extension"},next:{title:"CREATE FOREIGN DATA WRAPPER",permalink:"/docs/sql-stmts/create-foreign-data-wrapper"}},l={},d=[{value:"Synopsis",id:"synopsis",level:2},{value:"Description",id:"description",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Examples",id:"examples",level:2},{value:"Notes",id:"notes",level:2},{value:"Compatibility",id:"compatibility",level:2},{value:"See also",id:"see-also",level:2}];function c(e){const t={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"create-external-table",children:"CREATE EXTERNAL TABLE"}),"\n",(0,s.jsx)(t.p,{children:"Defines a new external table."}),"\n",(0,s.jsx)(t.h2,{id:"synopsis",children:"Synopsis"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"CREATE [READABLE] EXTERNAL [TEMPORARY | TEMP] TABLE <table_name>\xa0\xa0\xa0\xa0\xa0\n    ( <column_name> <data_type> [, ...] | LIKE <other_table >)\n\xa0\xa0\xa0\xa0\xa0LOCATION ('file://<seghost>[:<port>]/<path>/<file>' [, ...])\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0| ('gpfdist://<filehost>[:<port>]/<file_pattern>[#transform=<trans_name>]'\n           [, ...]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0| ('gpfdists://<filehost>[:<port>]/<file_pattern>[#transform=<trans_name>]'\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[, ...])\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0| ('pxf://<path-to-data>?PROFILE=<profile_name>[&SERVER=<server_name>][&<custom-option>=<value>[...]]'))\n\xa0\xa0\xa0\xa0 \xa0\xa0| ('s3://<S3_endpoint>[:<port>]/<bucket_name>/[<S3_prefix>] [region=<S3-region>] [config=<config_file> | config_server=<url>]')\n\xa0\xa0\xa0\xa0\xa0[ON COORDINATOR]\n\xa0\xa0\xa0\xa0\xa0FORMAT 'TEXT' \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[( [HEADER]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[DELIMITER [AS] '<delimiter>' | 'OFF']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[NULL [AS] '<null string>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[ESCAPE [AS] '<escape>' | 'OFF']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[NEWLINE [ AS ] 'LF' | 'CR' | 'CRLF']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[FILL MISSING FIELDS] )]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0| 'CSV'\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[( [HEADER]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[QUOTE [AS] '<quote>'] \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 [DELIMITER [AS] '<delimiter>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[NULL [AS] '<null string>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[FORCE NOT NULL <column> [, ...]]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[ESCAPE [AS] '<escape>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[NEWLINE [ AS ] 'LF' | 'CR' | 'CRLF']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[FILL MISSING FIELDS] )]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0| 'CUSTOM' (Formatter=<<formatter_specifications>>)\n    [ OPTIONS ( <key> '<value>' [, ...] ) ]\n\xa0\xa0\xa0\xa0[ ENCODING '<encoding>' ]\n \xa0\xa0\xa0  [ [LOG ERRORS [PERSISTENTLY]] SEGMENT REJECT LIMIT <count>\n\xa0\xa0\xa0\xa0\xa0\xa0[ROWS | PERCENT] ]\n\nCREATE [READABLE] EXTERNAL WEB [TEMPORARY | TEMP] TABLE <table_name>\xa0\xa0\xa0\xa0\xa0\n   ( <column_name> <data_type> [, ...] | LIKE <other_table >)\n\xa0\xa0\xa0\xa0\xa0\xa0LOCATION ('http://<webhost>[:<port>]/<path>/<file>' [, ...])\n\xa0\xa0\xa0\xa0| EXECUTE '<command>' [ON ALL \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0| COORDINATOR\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0| <number_of_segments>\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0| HOST ['<segment_hostname>'] \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0| SEGMENT <segment_id> ]\n\xa0\xa0\xa0\xa0\xa0\xa0FORMAT 'TEXT' \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[( [HEADER]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[DELIMITER [AS] '<delimiter>' | 'OFF']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[NULL [AS] '<null string>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[ESCAPE [AS] '<escape>' | 'OFF']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[NEWLINE [ AS ] 'LF' | 'CR' | 'CRLF']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[FILL MISSING FIELDS] )]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0| 'CSV'\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[( [HEADER]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[QUOTE [AS] '<quote>'] \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 [DELIMITER [AS] '<delimiter>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[NULL [AS] '<null string>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[FORCE NOT NULL <column> [, ...]]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[ESCAPE [AS] '<escape>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[NEWLINE [ AS ] 'LF' | 'CR' | 'CRLF']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[FILL MISSING FIELDS] )]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0| 'CUSTOM' (Formatter=<<formatter specifications>>)\n     [ OPTIONS ( <key> '<value>' [, ...] ) ]\n\xa0\xa0\xa0\xa0\xa0[ ENCODING '<encoding>' ]\n \xa0\xa0\xa0 [ [LOG ERRORS [PERSISTENTLY]] SEGMENT REJECT LIMIT <count>\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0[ROWS | PERCENT] ]\n\nCREATE WRITABLE EXTERNAL [TEMPORARY | TEMP] TABLE <table_name>\n\xa0\xa0\xa0\xa0( <column_name> <data_type> [, ...] | LIKE <other_table >)\n\xa0\xa0\xa0\xa0\xa0LOCATION('gpfdist://<outputhost>[:<port>]/<filename>[#transform=<trans_name>]'\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[, ...])\n\xa0\xa0\xa0\xa0\xa0\xa0| ('gpfdists://<outputhost>[:<port>]/<file_pattern>[#transform=<trans_name>]'\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[, ...])\n\xa0\xa0\xa0\xa0\xa0\xa0FORMAT 'TEXT' \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[( [DELIMITER [AS] '<delimiter>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[NULL [AS] '<null string>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[ESCAPE [AS] '<escape>' | 'OFF'] )]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0| 'CSV'\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[([QUOTE [AS] '<quote>'] \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 [DELIMITER [AS] '<delimiter>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[NULL [AS] '<null string>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[FORCE QUOTE <column> [, ...]] | * ]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[ESCAPE [AS] '<escape>'] )]\n\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0| 'CUSTOM' (Formatter=<<formatter specifications>>)\n    [ OPTIONS ( <key> '<value>' [, ...] ) ]\n\xa0\xa0\xa0\xa0[ ENCODING '<write_encoding>' ]\n\xa0\xa0\xa0\xa0[ DISTRIBUTED BY ({<column> [<opclass>]}, [ ... ] ) | DISTRIBUTED RANDOMLY ]\n\nCREATE WRITABLE EXTERNAL [TEMPORARY | TEMP] TABLE <table_name>\n\xa0\xa0\xa0\xa0( <column_name> <data_type> [, ...] | LIKE <other_table >)\n\xa0\xa0\xa0\xa0\xa0LOCATION('s3://<S3_endpoint>[:<port>]/<bucket_name>/[<S3_prefix>] [region=<S3-region>] [config=<config_file> | config_server=<url>]')\n\xa0\xa0\xa0\xa0\xa0\xa0[ON COORDINATOR]\n\xa0\xa0\xa0\xa0\xa0\xa0FORMAT 'TEXT' \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[( [DELIMITER [AS] '<delimiter>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[NULL [AS] '<null string>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[ESCAPE [AS] '<escape>' | 'OFF'] )]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0| 'CSV'\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[([QUOTE [AS] '<quote>'] \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 [DELIMITER [AS] '<delimiter>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[NULL [AS] '<null string>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[FORCE QUOTE <column> [, ...]] | * ]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[ESCAPE [AS] '<escape>'] )]\n\nCREATE WRITABLE EXTERNAL WEB [TEMPORARY | TEMP] TABLE <table_name>\n\xa0\xa0\xa0\xa0( <column_name> <data_type> [, ...] | LIKE <other_table> )\n\xa0\xa0\xa0\xa0EXECUTE '<command>' [ON ALL]\n\xa0\xa0\xa0\xa0FORMAT 'TEXT' \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[( [DELIMITER [AS] '<delimiter>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[NULL [AS] '<null string>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[ESCAPE [AS] '<escape>' | 'OFF'] )]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0| 'CSV'\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[([QUOTE [AS] '<quote>'] \n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 [DELIMITER [AS] '<delimiter>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[NULL [AS] '<null string>']\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[FORCE QUOTE <column> [, ...]] | * ]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0[ESCAPE [AS] '<escape>'] )]\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0| 'CUSTOM' (Formatter=<<formatter specifications>>)\n    [ OPTIONS ( <key> '<value>' [, ...] ) ]\n\xa0\xa0\xa0\xa0[ ENCODING '<write_encoding>' ]\n\xa0\xa0\xa0\xa0[ DISTRIBUTED BY ({<column> [<opclass>]}, [ ... ] ) | DISTRIBUTED RANDOMLY ]\n"})}),"\n",(0,s.jsx)(t.h2,{id:"description",children:"Description"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"CREATE EXTERNAL TABLE"})," or ",(0,s.jsx)(t.code,{children:"CREATE EXTERNAL WEB TABLE"})," creates a new readable external table definition in Cloudberry Database. Readable external tables are typically used for fast, parallel data loading. Once an external table is defined, you can query its data directly (and in parallel) using SQL commands. For example, you can select, join, or sort external table data. You can also create views for external tables. DML operations (",(0,s.jsx)(t.code,{children:"UPDATE"}),", ",(0,s.jsx)(t.code,{children:"INSERT"}),", ",(0,s.jsx)(t.code,{children:"DELETE"}),", or ",(0,s.jsx)(t.code,{children:"TRUNCATE"}),") are not allowed on readable external tables, and you cannot create indexes on readable external tables."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"CREATE WRITABLE EXTERNAL TABLE"})," or ",(0,s.jsx)(t.code,{children:"CREATE WRITABLE EXTERNAL WEB TABLE"})," creates a new writable external table definition in Cloudberry Database. Writable external tables are typically used for unloading data from the database into a set of files or named pipes. Writable external web tables can also be used to output data to an executable program. Once a writable external table is defined, data can be selected from database tables and inserted into the writable external table. Writable external tables only allow ",(0,s.jsx)(t.code,{children:"INSERT"})," operations \u2013 ",(0,s.jsx)(t.code,{children:"SELECT"}),", ",(0,s.jsx)(t.code,{children:"UPDATE"}),", ",(0,s.jsx)(t.code,{children:"DELETE"})," or ",(0,s.jsx)(t.code,{children:"TRUNCATE"})," are not allowed."]}),"\n",(0,s.jsx)(t.p,{children:"The main difference between regular external tables and external web tables is their data sources. Regular readable external tables access static flat files, whereas external web tables access dynamic data sources \u2013 either on a web server or by running OS commands or scripts."}),"\n",(0,s.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"READABLE | WRITABLE"})})}),"\n",(0,s.jsx)(t.p,{children:"Specifies the type of external table, readable being the default. Readable external tables are used for loading data into Cloudberry Database. Writable external tables are used for unloading data."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"WEB"})})}),"\n",(0,s.jsxs)(t.p,{children:["Creates a readable or writable external web table definition in Cloudberry Database. There are two forms of readable external web tables \u2013 those that access files via the ",(0,s.jsx)(t.code,{children:"http://"})," protocol or those that access data by running OS commands. Writable external web tables output data to an executable program that can accept an input stream of data. External web tables are not rescannable during query execution."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"s3"})," protocol does not support external web tables. You can, however, create an external web table that runs a third-party tool to read data from or write data to S3 directly."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"TEMPORARY | TEMP"})})}),"\n",(0,s.jsx)(t.p,{children:"If specified, creates a temporary readable or writable external table definition in Cloudberry Database. Temporary external tables exist in a special schema; you cannot specify a schema name when you create the table. Temporary external tables are automatically dropped at the end of a session."}),"\n",(0,s.jsx)(t.p,{children:"An existing permanent table with the same name is not visible to the current session while the temporary table exists, unless you reference the permanent table with its schema-qualified name."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"table_name"})})}),"\n",(0,s.jsx)(t.p,{children:"The name of the new external table."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"column_name"})})}),"\n",(0,s.jsx)(t.p,{children:"The name of a column to create in the external table definition. Unlike regular tables, external tables do not have column constraints or default values, so do not specify those."}),"\n",(0,s.jsxs)(t.p,{children:["LIKE other_table\nThe ",(0,s.jsx)(t.code,{children:"LIKE"})," clause specifies a table from which the new external table automatically copies all column names, data types and Cloudberry distribution policy. If the original table specifies any column constraints or default column values, those will not be copied over to the new external table definition."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"data_type"})})}),"\n",(0,s.jsx)(t.p,{children:"The data type of the column."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"LOCATION ('protocol://[host[:port]]/path/file' [, ...])"})})}),"\n",(0,s.jsxs)(t.p,{children:["If you use the ",(0,s.jsx)(t.code,{children:"pxf"})," protocol to access an external data source, refer to pxf:// Protocol for information about the ",(0,s.jsx)(t.code,{children:"pxf"})," protocol."]}),"\n",(0,s.jsxs)(t.p,{children:["For readable external tables, specifies the URI of the external data source(s) to be used to populate the external table or web table. Regular readable external tables allow the ",(0,s.jsx)(t.code,{children:"gpfdist"})," or ",(0,s.jsx)(t.code,{children:"file"})," protocols. External web tables allow the ",(0,s.jsx)(t.code,{children:"http"})," protocol. If ",(0,s.jsx)(t.code,{children:"port"})," is omitted, port ",(0,s.jsx)(t.code,{children:"8080"})," is assumed for ",(0,s.jsx)(t.code,{children:"http"})," and ",(0,s.jsx)(t.code,{children:"gpfdist"})," protocols. If using the ",(0,s.jsx)(t.code,{children:"gpfdist"})," protocol, the ",(0,s.jsx)(t.code,{children:"path"})," is relative to the directory from which ",(0,s.jsx)(t.code,{children:"gpfdist"})," is serving files (the directory specified when you started the ",(0,s.jsx)(t.code,{children:"gpfdist"})," program). Also, ",(0,s.jsx)(t.code,{children:"gpfdist"})," can use wildcards or other C-style pattern matching (for example, a whitespace character is ",(0,s.jsx)(t.code,{children:"[[:space:]]"}),") to denote multiple files in a directory. For example:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"'gpfdist://filehost:8081/*'\n'gpfdist://coordinatorhost/my_load_file'\n'file://seghost1/dbfast1/external/myfile.txt'\n'http://intranet.example.com/finance/expenses.csv'\n"})}),"\n",(0,s.jsxs)(t.p,{children:["For writable external tables, specifies the URI location of the ",(0,s.jsx)(t.code,{children:"gpfdist"})," process or S3 protocol that will collect data output from the Cloudberry segments and write it to one or more named files. For ",(0,s.jsx)(t.code,{children:"gpfdist"})," the ",(0,s.jsx)(t.code,{children:"path"})," is relative to the directory from which ",(0,s.jsx)(t.code,{children:"gpfdist"})," is serving files (the directory specified when you started the ",(0,s.jsx)(t.code,{children:"gpfdist"})," program). If multiple ",(0,s.jsx)(t.code,{children:"gpfdist"})," locations are listed, the segments sending data will be evenly divided across the available output locations. For example:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"'gpfdist://outputhost:8081/data1.out',\n'gpfdist://outputhost:8081/data2.out'\n"})}),"\n",(0,s.jsxs)(t.p,{children:["With two ",(0,s.jsx)(t.code,{children:"gpfdist"})," locations listed as in the above example, half of the segments would send their output data to the ",(0,s.jsx)(t.code,{children:"data1.out"})," file and the other half to the ",(0,s.jsx)(t.code,{children:"data2.out"})," file."]}),"\n",(0,s.jsxs)(t.p,{children:["With the option ",(0,s.jsx)(t.code,{children:"#transform=trans_name"}),", you can specify a transform to apply when loading or extracting data. The trans_name is the name of the transform in the YAML configuration file you specify with the you run the ",(0,s.jsx)(t.code,{children:"gpfdist"})," utility."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"ON COORDINATOR"})})}),"\n",(0,s.jsxs)(t.p,{children:["Restricts all table-related operations to the Cloudberry Database coordinator segment. Permitted only on readable and writable external tables created with the ",(0,s.jsx)(t.code,{children:"s3"})," or custom protocols. The ",(0,s.jsx)(t.code,{children:"gpfdist"}),", ",(0,s.jsx)(t.code,{children:"gpfdists"}),", ",(0,s.jsx)(t.code,{children:"pxf"}),", and ",(0,s.jsx)(t.code,{children:"file"})," protocols do not support ",(0,s.jsx)(t.code,{children:"ON COORDINATOR"}),"."]}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"})," Be aware of potential resource impacts when reading from or writing to external tables you create with the ",(0,s.jsx)(t.code,{children:"ON COORDINATOR"})," clause. You may encounter performance issues when you restrict table operations solely to the Cloudberry Database coordinator segment."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"EXECUTE 'command' [ON ...]"})})}),"\n",(0,s.jsxs)(t.p,{children:["Allowed for readable external web tables or writable external tables only. For readable external web tables, specifies the OS command to be run by the segment instances. The command can be a single OS command or a script. The ",(0,s.jsx)(t.code,{children:"ON"})," clause is used to specify which segment instances will run the given command."]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"ON ALL"})," is the default. The command will be run by every active (primary) segment instance on all segment hosts in the Cloudberry Database system. If the command runs a script, that script must reside in the same location on all of the segment hosts and be executable by the Cloudberry superuser (",(0,s.jsx)(t.code,{children:"gpadmin"}),")."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"ON COORDINATOR"})," runs the command on the coordinator host only."]}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"})," Logging is not supported for external web tables when the ",(0,s.jsx)(t.code,{children:"ON COORDINATOR"})," clause is specified."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"ON number"})," means the command will be run by the specified number of segments. The particular segments are chosen randomly at runtime by the Cloudberry Database system. If the command runs a script, that script must reside in the same location on all of the segment hosts and be executable by the Cloudberry superuser (",(0,s.jsx)(t.code,{children:"gpadmin"}),")."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"HOST"})," means the command will be run by one segment on each segment host (once per segment host), regardless of the number of active segment instances per host."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"HOST segment_hostname"})," means the command will be run by all active (primary) segment instances on the specified segment host."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"SEGMENT segment_id"})," means the command will be run only once by the specified segment. You can determine a segment instance's ID by looking at the content number in the system catalog table gp_segment_configuration. The content ID of the Cloudberry Database coordinator is always ",(0,s.jsx)(t.code,{children:"-1"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["For writable external tables, the command specified in the ",(0,s.jsx)(t.code,{children:"EXECUTE"})," clause must be prepared to have data piped into it. Since all segments that have data to send will write their output to the specified command or program, the only available option for the ",(0,s.jsx)(t.code,{children:"ON"})," clause is ",(0,s.jsx)(t.code,{children:"ON ALL"}),"."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"FORMAT 'TEXT | CSV' (options)"})})}),"\n",(0,s.jsxs)(t.p,{children:["When the ",(0,s.jsx)(t.code,{children:"FORMAT"})," clause identfies delimited text (",(0,s.jsx)(t.code,{children:"TEXT"}),") or comma separated values (",(0,s.jsx)(t.code,{children:"CSV"}),") format, formatting options are similar to those available with the PostgreSQL ",(0,s.jsx)(t.a,{href:"/docs/sql-stmts/copy",children:"COPY"})," command. If the data in the file does not use the default column delimiter, escape character, null string and so on, you must specify the additional formatting options so that the data in the external file is read correctly by Cloudberry Database."]}),"\n",(0,s.jsxs)(t.p,{children:["If you use the ",(0,s.jsx)(t.code,{children:"pxf"})," protocol to access an external data source, refer to Accessing External Data with PXF for information about using PXF."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"FORMAT 'CUSTOM' (formatter=formatter_specification)"})})}),"\n",(0,s.jsxs)(t.p,{children:["Specifies a custom data format. The formatter_specification specifies the function to use to format the data, followed by comma-separated parameters to the formatter function. The length of the formatter specification, the string including ",(0,s.jsx)(t.code,{children:"Formatter="}),", can be up to approximately 50K bytes."]}),"\n",(0,s.jsxs)(t.p,{children:["If you use the ",(0,s.jsx)(t.code,{children:"pxf"})," protocol to access an external data source, refer to Accessing External Data with PXF for information about using PXF."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"DELIMITER"})})}),"\n",(0,s.jsxs)(t.p,{children:["Specifies a single ASCII character that separates columns within each row (line) of data. The default is a tab character in ",(0,s.jsx)(t.code,{children:"TEXT"})," mode, a comma in ",(0,s.jsx)(t.code,{children:"CSV"})," mode. In ",(0,s.jsx)(t.code,{children:"TEXT"})," mode for readable external tables, the delimiter can be set to ",(0,s.jsx)(t.code,{children:"OFF"})," for special use cases in which unstructured data is loaded into a single-column table."]}),"\n",(0,s.jsxs)(t.p,{children:["For the ",(0,s.jsx)(t.code,{children:"s3"})," protocol, the delimiter cannot be a newline character (",(0,s.jsx)(t.code,{children:"\\n"}),") or a carriage return character (",(0,s.jsx)(t.code,{children:"\\r"}),")."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"NULL"})})}),"\n",(0,s.jsxs)(t.p,{children:["Specifies the string that represents a ",(0,s.jsx)(t.code,{children:"NULL"})," value. The default is ",(0,s.jsx)(t.code,{children:"\\N"})," (backslash-N) in ",(0,s.jsx)(t.code,{children:"TEXT"})," mode, and an empty value with no quotations in ",(0,s.jsx)(t.code,{children:"CSV"})," mode. You might prefer an empty string even in ",(0,s.jsx)(t.code,{children:"TEXT"})," mode for cases where you do not want to distinguish ",(0,s.jsx)(t.code,{children:"NULL"})," values from empty strings. When using external and web tables, any data item that matches this string will be considered a ",(0,s.jsx)(t.code,{children:"NULL"})," value."]}),"\n",(0,s.jsxs)(t.p,{children:["As an example for the ",(0,s.jsx)(t.code,{children:"text"})," format, this ",(0,s.jsx)(t.code,{children:"FORMAT"})," clause can be used to specify that the string of two single quotes (",(0,s.jsx)(t.code,{children:"''"}),") is a ",(0,s.jsx)(t.code,{children:"NULL"})," value."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"FORMAT 'text' (delimiter ',' null '\\'\\'\\'\\'' )\n"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"ESCAPE"})})}),"\n",(0,s.jsxs)(t.p,{children:["Specifies the single character that is used for C escape sequences (such as ",(0,s.jsx)(t.code,{children:"\\n"}),",",(0,s.jsx)(t.code,{children:"\\t"}),",",(0,s.jsx)(t.code,{children:"\\100"}),", and so on) and for escaping data characters that might otherwise be taken as row or column delimiters. Make sure to choose an escape character that is not used anywhere in your actual column data. The default escape character is a ",(0,s.jsx)(t.code,{children:"\\"})," (backslash) for text-formatted files and a ",(0,s.jsx)(t.code,{children:'"'})," (double quote) for csv-formatted files, however it is possible to specify another character to represent an escape. It is also possible to deactivate escaping in text-formatted files by specifying the value ",(0,s.jsx)(t.code,{children:"'OFF'"})," as the escape value. This is very useful for data such as text-formatted web log data that has many embedded backslashes that are not intended to be escapes."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"NEWLINE"})})}),"\n",(0,s.jsxs)(t.p,{children:["Specifies the newline used in your data files \u2013 ",(0,s.jsx)(t.code,{children:"LF"})," (Line feed, 0x0A), ",(0,s.jsx)(t.code,{children:"CR"})," (Carriage return, 0x0D), or ",(0,s.jsx)(t.code,{children:"CRLF"})," (Carriage return plus line feed, 0x0D 0x0A). If not specified, a Cloudberry Database segment will detect the newline type by looking at the first row of data it receives and using the first newline type encountered."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"HEADER"})})}),"\n",(0,s.jsx)(t.p,{children:"For readable external tables, specifies that the first line in the data file(s) is a header row (contains the names of the table columns) and should not be included as data for the table. If using multiple data source files, all files must have a header row."}),"\n",(0,s.jsxs)(t.p,{children:["For the ",(0,s.jsx)(t.code,{children:"s3"})," protocol, the column names in the header row cannot contain a newline character (",(0,s.jsx)(t.code,{children:"\\n"}),") or a carriage return (",(0,s.jsx)(t.code,{children:"\\r"}),")."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"pxf"})," protocol does not support the ",(0,s.jsx)(t.code,{children:"HEADER"})," formatting option."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"QUOTE"})})}),"\n",(0,s.jsxs)(t.p,{children:["Specifies the quotation character for ",(0,s.jsx)(t.code,{children:"CSV"})," mode. The default is double-quote (",(0,s.jsx)(t.code,{children:'"'}),")."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"FORCE NOT NULL"})})}),"\n",(0,s.jsxs)(t.p,{children:["In ",(0,s.jsx)(t.code,{children:"CSV"})," mode, processes each specified column as though it were quoted and hence not a ",(0,s.jsx)(t.code,{children:"NULL"})," value. For the default null string in ",(0,s.jsx)(t.code,{children:"CSV"})," mode (nothing between two delimiters), this causes missing values to be evaluated as zero-length strings."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"FORCE QUOTE"})})}),"\n",(0,s.jsxs)(t.p,{children:["In ",(0,s.jsx)(t.code,{children:"CSV"})," mode for writable external tables, forces quoting to be used for all non-",(0,s.jsx)(t.code,{children:"NULL"})," values in each specified column. If ",(0,s.jsx)(t.code,{children:"*"})," is specified then non-",(0,s.jsx)(t.code,{children:"NULL"})," values will be quoted in all columns. ",(0,s.jsx)(t.code,{children:"NULL"})," output is never quoted."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"FILL MISSING FIELDS"})})}),"\n",(0,s.jsxs)(t.p,{children:["In both ",(0,s.jsx)(t.code,{children:"TEXT"})," and ",(0,s.jsx)(t.code,{children:"CSV"})," mode for readable external tables, specifying ",(0,s.jsx)(t.code,{children:"FILL MISSING FIELDS"})," will set missing trailing field values to ",(0,s.jsx)(t.code,{children:"NULL"})," (instead of reporting an error) when a row of data has missing data fields at the end of a line or row. Blank rows, fields with a ",(0,s.jsx)(t.code,{children:"NOT NULL"})," constraint, and trailing delimiters on a line will still report an error."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"OPTIONS key 'value'[, key' value' ...]"})})}),"\n",(0,s.jsx)(t.p,{children:"Optional. Specifies parameters and values as key-value pairs that are set to a custom data access protocol when the protocol is used as a external table protocol for an external table. It is the responsibility of the custom data access protocol to process and validate the key-value pairs."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"ENCODING 'encoding'"})})}),"\n",(0,s.jsxs)(t.p,{children:["Character set encoding to use for the external table. Specify a string constant (such as ",(0,s.jsx)(t.code,{children:"'SQL_ASCII'"}),"), an integer encoding number, or ",(0,s.jsx)(t.code,{children:"DEFAULT"})," to use the default server encoding. See Character Set Support."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"LOG ERRORS [PERSISTENTLY]"})})}),"\n",(0,s.jsxs)(t.p,{children:["This is an optional clause that can precede a ",(0,s.jsx)(t.code,{children:"SEGMENT REJECT LIMIT"})," clause to log information about rows with formatting errors. The error log data is stored internally. If error log data exists for a specified external table, new data is appended to existing error log data. The error log data is not replicated to mirror segments."]}),"\n",(0,s.jsxs)(t.p,{children:["The data is deleted when the external table is dropped unless you specify the keyword ",(0,s.jsx)(t.code,{children:"PERSISTENTLY"}),". If the keyword is specified, the log data persists after the external table is dropped."]}),"\n",(0,s.jsxs)(t.p,{children:["The error log data is accessed with the Cloudberry Database built-in SQL function ",(0,s.jsx)(t.code,{children:"gp_read_error_log()"}),", or with the SQL function ",(0,s.jsx)(t.code,{children:"gp_read_persistent_error_log()"})," if the ",(0,s.jsx)(t.code,{children:"PERSISTENTLY"})," keyword is specified."]}),"\n",(0,s.jsxs)(t.p,{children:["If you use the ",(0,s.jsx)(t.code,{children:"PERSISTENTLY"})," keyword, you must install the functions that manage the persistent error log information."]}),"\n",(0,s.jsxs)(t.p,{children:["See ",(0,s.jsx)(t.a,{href:"#notes",children:"Notes"})," for information about the error log information and built-in functions for viewing and managing error log information."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"SEGMENT REJECT LIMIT count [ROWS | PERCENT]"})})}),"\n",(0,s.jsxs)(t.p,{children:["Runs a ",(0,s.jsx)(t.code,{children:"COPY FROM"})," operation in single row error isolation mode. If the input rows have format errors they will be discarded provided that the reject limit count is not reached on any Cloudberry segment instance during the load operation. The reject limit count can be specified as number of rows (the default) or percentage of total rows (1-100). If ",(0,s.jsx)(t.code,{children:"PERCENT"})," is used, each segment starts calculating the bad row percentage only after the number of rows specified by the parameter ",(0,s.jsx)(t.code,{children:"gp_reject_percent_threshold"})," has been processed. The default for ",(0,s.jsx)(t.code,{children:"gp_reject_percent_threshold"})," is 300 rows. Constraint errors such as violation of a ",(0,s.jsx)(t.code,{children:"NOT NULL"}),", ",(0,s.jsx)(t.code,{children:"CHECK"}),", or ",(0,s.jsx)(t.code,{children:"UNIQUE"}),' constraint will still be handled in "all-or-nothing" input mode. If the limit is not reached, all good rows will be loaded and any error rows discarded.']}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"})," When reading an external table, Cloudberry Database limits the initial number of rows that can contain formatting errors if the ",(0,s.jsx)(t.code,{children:"SEGMENT REJECT LIMIT"})," is not triggered first or is not specified. If the first 1000 rows are rejected, the ",(0,s.jsx)(t.code,{children:"COPY"})," operation is stopped and rolled back."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["You can change the limit for the number of initial rejected rows with the Cloudberry Database server configuration parameter ",(0,s.jsx)(t.code,{children:"gp_initial_bad_row_limit"}),"."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"DISTRIBUTED BY ({column [opclass]}, [ ... ] )"})})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"DISTRIBUTED RANDOMLY"})})}),"\n",(0,s.jsxs)(t.p,{children:["Used to declare the Cloudberry Database distribution policy for a writable external table. By default, writable external tables are distributed randomly. If the source table you are exporting data from has a hash distribution policy, defining the same distribution key column(s) and operator class(es), ",(0,s.jsx)(t.code,{children:"oplcass"}),", for the writable external table will improve unload performance by eliminating the need to move rows over the interconnect. When you issue an unload command such as ",(0,s.jsx)(t.code,{children:"INSERT INTO wex_table SELECT * FROM source_table"}),", the rows that are unloaded can be sent directly from the segments to the output location if the two tables have the same hash distribution policy."]}),"\n",(0,s.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,s.jsxs)(t.p,{children:["Start the ",(0,s.jsx)(t.code,{children:"gpfdist"})," file server program in the background on port ",(0,s.jsx)(t.code,{children:"8081"})," serving files from directory ",(0,s.jsx)(t.code,{children:"/var/data/staging"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"gpfdist -p 8081 -d /var/data/staging -l /home/<gpadmin>/log &\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Create a readable external table named ",(0,s.jsx)(t.code,{children:"ext_customer"})," using the ",(0,s.jsx)(t.code,{children:"gpfdist"})," protocol and any text formatted files (",(0,s.jsx)(t.code,{children:"*.txt"}),") found in the ",(0,s.jsx)(t.code,{children:"gpfdist"})," directory. The files are formatted with a pipe (",(0,s.jsx)(t.code,{children:"|"}),") as the column delimiter and an empty space as ",(0,s.jsx)(t.code,{children:"NULL"}),". Also access the external table in single row error isolation mode:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"CREATE EXTERNAL TABLE ext_customer\n\xa0\xa0\xa0(id int, name text, sponsor text) \n\xa0\xa0\xa0LOCATION ( 'gpfdist://filehost:8081/*.txt' ) \n\xa0\xa0\xa0FORMAT 'TEXT' ( DELIMITER '|' NULL ' ')\n\xa0\xa0\xa0LOG ERRORS SEGMENT REJECT LIMIT 5;\n"})}),"\n",(0,s.jsx)(t.p,{children:"Create the same readable external table definition as above, but with CSV formatted files:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"CREATE EXTERNAL TABLE ext_customer \n\xa0\xa0\xa0(id int, name text, sponsor text) \n\xa0\xa0\xa0LOCATION ( 'gpfdist://filehost:8081/*.csv' ) \n\xa0\xa0\xa0FORMAT 'CSV' ( DELIMITER ',' );\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Create a readable external table named ",(0,s.jsx)(t.code,{children:"ext_expenses"})," using the ",(0,s.jsx)(t.code,{children:"file"})," protocol and several CSV formatted files that have a header row:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"CREATE EXTERNAL TABLE ext_expenses (name text, date date, \namount float4, category text, description text) \nLOCATION ( \n'file://seghost1/dbfast/external/expenses1.csv',\n'file://seghost1/dbfast/external/expenses2.csv',\n'file://seghost2/dbfast/external/expenses3.csv',\n'file://seghost2/dbfast/external/expenses4.csv',\n'file://seghost3/dbfast/external/expenses5.csv',\n'file://seghost3/dbfast/external/expenses6.csv' \n)\nFORMAT 'CSV' ( HEADER );\n"})}),"\n",(0,s.jsx)(t.p,{children:"Create a readable external web table that runs a script once per segment host:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"CREATE EXTERNAL WEB TABLE log_output (linenum int, message \ntext) \xa0EXECUTE '/var/load_scripts/get_log_data.sh' ON HOST \n\xa0FORMAT 'TEXT' (DELIMITER '|');\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Create a writable external table named ",(0,s.jsx)(t.code,{children:"sales_out"})," that uses ",(0,s.jsx)(t.code,{children:"gpfdist"})," to write output data to a file named ",(0,s.jsx)(t.code,{children:"sales.out"}),". The files are formatted with a pipe (",(0,s.jsx)(t.code,{children:"|"}),") as the column delimiter and an empty space as ",(0,s.jsx)(t.code,{children:"NULL"}),"."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"CREATE WRITABLE EXTERNAL TABLE sales_out (LIKE sales) \n\xa0\xa0\xa0LOCATION ('gpfdist://etl1:8081/sales.out')\n\xa0\xa0\xa0FORMAT 'TEXT' ( DELIMITER '|' NULL ' ')\n\xa0\xa0\xa0DISTRIBUTED BY (txn_id);\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Create a writable external web table that pipes output data received by the segments to an executable script named ",(0,s.jsx)(t.code,{children:"to_adreport_etl.sh"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"CREATE WRITABLE EXTERNAL WEB TABLE campaign_out \n(LIKE campaign) \n\xa0EXECUTE '/var/unload_scripts/to_adreport_etl.sh'\n\xa0FORMAT 'TEXT' (DELIMITER '|');\n"})}),"\n",(0,s.jsx)(t.p,{children:"Use the writable external table defined above to unload selected data:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"INSERT INTO campaign_out SELECT * FROM campaign WHERE customer_id=123;\n"})}),"\n",(0,s.jsx)(t.h2,{id:"notes",children:"Notes"}),"\n",(0,s.jsxs)(t.p,{children:["When you specify the ",(0,s.jsx)(t.code,{children:"LOG ERRORS"})," clause, Cloudberry Database captures errors that occur while reading the external table data."]}),"\n",(0,s.jsxs)(t.p,{children:["You can view and manage the captured error log data. The functions to manage log data depend on whether the data is persistent (the ",(0,s.jsx)(t.code,{children:"PERSISTENTLY"})," keyword is used with the ",(0,s.jsx)(t.code,{children:"LOG ERRORS"})," clause)."]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Functions that manage non-persistent error log data from external tables that were defined without the ",(0,s.jsx)(t.code,{children:"PERSISTENTLY"})," keyword."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["The built-in SQL function ",(0,s.jsx)(t.code,{children:"gp_read_error_log('table_name')"})," displays error log information for an external table. This example displays the error log data from the external table ",(0,s.jsx)(t.code,{children:"ext_expenses"}),"."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"SELECT * from gp_read_error_log('ext_expenses');\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The function returns no data if you created the external table with the ",(0,s.jsx)(t.code,{children:"LOG ERRORS PERSISTENTLY"})," clause, or if the external table does not exist."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["The built-in SQL function ",(0,s.jsx)(t.code,{children:"gp_truncate_error_log('table_name')"})," deletes the error log data for table_name. This example deletes the error log data captured from the external table ",(0,s.jsx)(t.code,{children:"ext_expenses"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sql",children:"SELECT gp_truncate_error_log('ext_expenses'); \n"})}),"\n",(0,s.jsxs)(t.p,{children:["Dropping the table also deletes the table's log data. The function does not truncate log data if the external table is defined with the ",(0,s.jsx)(t.code,{children:"LOG ERRORS PERSISTENTLY"})," clause."]}),"\n",(0,s.jsxs)(t.p,{children:["The function returns ",(0,s.jsx)(t.code,{children:"FALSE"})," if the table does not exist."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Functions that manage persistent error log data from external tables that were defined with the ",(0,s.jsx)(t.code,{children:"PERSISTENTLY"})," keyword."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["The SQL function ",(0,s.jsx)(t.code,{children:"gp_read_persistent_error_log('table_name')"})," displays persistent log data for an external table."]}),"\n",(0,s.jsxs)(t.p,{children:["The function returns no data if you created the external table without the ",(0,s.jsx)(t.code,{children:"PERSISTENTLY"})," keyword. The function returns persistent log data for an external table even after the table has been dropped."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["The SQL function ",(0,s.jsx)(t.code,{children:"gp_truncate_persistent_error_log('table_name')"})," truncates persistent log data for a table."]}),"\n",(0,s.jsx)(t.p,{children:"For persistent log data, you must manually delete the data. Dropping the external table does not delete persistent log data."}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"These items apply to both non-persistent and persistent error log data and the related functions."}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"gp_read_*"})," functions require ",(0,s.jsx)(t.code,{children:"SELECT"})," privilege on the table."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"gp_truncate_*"})," functions require owner privilege on the table."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["You can use the ",(0,s.jsx)(t.code,{children:"*"})," wildcard character to delete error log information for existing tables in the current database. Specify the string ",(0,s.jsx)(t.code,{children:"*.*"})," to delete all database error log information, including error log information that was not deleted due to previous database issues. If ",(0,s.jsx)(t.code,{children:"*"})," is specified, database owner privilege is required. If ",(0,s.jsx)(t.code,{children:"*.*"})," is specified, operating system super-user privilege is required. Non-persistent and persistent error log data must be deleted with their respective ",(0,s.jsx)(t.code,{children:"gp_truncate_*"})," functions."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["When multiple Cloudberry Database external tables are defined with the ",(0,s.jsx)(t.code,{children:"gpfdist"}),", ",(0,s.jsx)(t.code,{children:"gpfdists"}),", or ",(0,s.jsx)(t.code,{children:"file"})," protocol and access the same named pipe a Linux system, Cloudberry Database restricts access to the named pipe to a single reader. An error is returned if a second reader attempts to access the named pipe."]}),"\n",(0,s.jsx)(t.h2,{id:"compatibility",children:"Compatibility"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"CREATE EXTERNAL TABLE"})," is a Cloudberry Database extension. The SQL standard makes no provisions for external tables."]}),"\n",(0,s.jsx)(t.h2,{id:"see-also",children:"See also"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"/docs/sql-stmts/create-table-as",children:"CREATE TABLE AS"}),", ",(0,s.jsx)(t.a,{href:"/docs/sql-stmts/create-table",children:"CREATE TABLE"}),", ",(0,s.jsx)(t.a,{href:"/docs/sql-stmts/copy",children:"COPY"}),", ",(0,s.jsx)(t.a,{href:"/docs/sql-stmts/select-into",children:"SELECT INTO"}),", ",(0,s.jsx)(t.a,{href:"/docs/sql-stmts/insert",children:"INSERT"})]})]})}function h(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},11151:(e,t,n)=>{n.d(t,{Z:()=>o,a:()=>i});var s=n(67294);const r={},a=s.createContext(r);function i(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);