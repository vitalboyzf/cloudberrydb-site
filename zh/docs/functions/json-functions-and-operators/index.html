<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-functions/json-functions-and-operators" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">JSON Functions and Operators | Apache Cloudberry (Incubating)</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://cloudberry.apache.org/zh/docs/functions/json-functions-and-operators"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="JSON Functions and Operators | Apache Cloudberry (Incubating)"><meta data-rh="true" name="description" content="This document describes:"><meta data-rh="true" property="og:description" content="This document describes:"><link data-rh="true" rel="icon" href="/zh/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://cloudberry.apache.org/zh/docs/functions/json-functions-and-operators"><link data-rh="true" rel="alternate" href="https://cloudberry.apache.org/docs/functions/json-functions-and-operators" hreflang="en"><link data-rh="true" rel="alternate" href="https://cloudberry.apache.org/zh/docs/functions/json-functions-and-operators" hreflang="zh"><link data-rh="true" rel="alternate" href="https://cloudberry.apache.org/docs/functions/json-functions-and-operators" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/zh/blog/rss.xml" title="Apache Cloudberry (Incubating) is one advanced and mature open-source MPP (Massively Parallel Processing) databases available. RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh/blog/atom.xml" title="Apache Cloudberry (Incubating) is one advanced and mature open-source MPP (Massively Parallel Processing) databases available. Atom Feed">
<link rel="alternate" type="application/json" href="/zh/blog/feed.json" title="Apache Cloudberry (Incubating) is one advanced and mature open-source MPP (Massively Parallel Processing) databases available. JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5RF5B25JHD"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-5RF5B25JHD",{anonymize_ip:!0})</script><link rel="stylesheet" href="/zh/assets/css/styles.49b95a11.css">
<script src="/zh/assets/js/runtime~main.f9358c35.js" defer="defer"></script>
<script src="/zh/assets/js/main.dc7bf7f2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><div class="tipsWrap_WWTe"><div class="tipsContent_sMsy"><div class="text_VINd"><a href="https://github.com/cloudberrydb/cloudberrydb" target="_blank" rel="noopener noreferrer"><span>If you like Apache Cloudberry (Incubating), give it a star on GitHub! </span><img src="/img/home/hcard/star.svg" alt=""></a></div><div class="close_vVex"><img src="/img/home/hcard/close.svg" alt=""></div></div></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div class="nav-left-logo"><a class="navbar__brand" href="/zh/"><div class="navbar__logo"><img src="/zh/img/apache_cloudberry_color_black.svg" alt="Cloudberry Database" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/zh/img/apache_cloudberry_color_white.svg" alt="Cloudberry Database" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a></div></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh/docs/">文档</a><a class="navbar__item navbar__link" href="/zh/community">社区</a><a class="navbar__item navbar__link" href="/zh/contribute">贡献</a><a class="navbar__item navbar__link" href="/zh/blog">博客</a><a class="navbar__item navbar__link" href="/zh/docs/releases">下载</a><a class="navbar__item navbar__link" href="/zh/support">支持</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">资源中心</a><ul class="dropdown__menu"><li><a href="https://github.com/apache/cloudberry/discussions/369" target="_blank" rel="noopener noreferrer" class="dropdown__link">路线图</a></li><li><a href="https://github.com/apache/cloudberry/discussions" target="_blank" rel="noopener noreferrer" class="dropdown__link">论坛</a></li><li><a class="dropdown__link" href="/zh/bootcamp">训练营</a></li><li><a class="dropdown__link" href="/zh/team">团队</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">ASF</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Foundation</a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">License</a></li><li><a href="https://www.apache.org/events/current-event.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Events</a></li><li><a href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy</a></li><li><a href="https://github.com/apache/cloudberry/blob/main/SECURITY.md" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsorship</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Thanks</a></li><li><a href="https://www.apache.org/foundation/policies/conduct" target="_blank" rel="noopener noreferrer" class="dropdown__link">Code of Conduct</a></li></ul></div><div class="toggle_vylO colorModeToggle_x44X check-theme-switch"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为暗黑模式）" aria-label="切换浅色/暗黑模式（当前为暗黑模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_dCNk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_BF9v"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_Rg9N"><aside class="theme-doc-sidebar-container docSidebarContainer_RSuS"><div class="sidebarViewport_pYEE"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/">产品介绍</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/cbdb-macos-compile">部署和构建</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/data-loading/">加载数据</a><button aria-label="展开侧边栏分类 &#x27;加载数据&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/create-and-manage-database">创建和准备数据库</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/basic-query-syntax">操作数据</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/performance/">优化查询性能</a><button aria-label="展开侧边栏分类 &#x27;优化查询性能&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/security/">设置安全和权限</a><button aria-label="展开侧边栏分类 &#x27;设置安全和权限&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/sys-admin/backup-and-restore/">Manage System</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/zh/docs/sql-stmts/">参考指南</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/docs/sql-stmts/">SQL 语句</a><button aria-label="展开侧边栏分类 &#x27;SQL 语句&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/data-types">数据类型</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/zh/docs/functions/">Built-in Functions</a><button aria-label="折叠侧边栏分类 &#x27;Built-in Functions&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh/docs/functions/json-functions-and-operators">JSON Functions and Operators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/functions/window-functions">Window Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/functions/advanced-aggregate-functions">Advanced Aggregate Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/functions/text-search-functions-and-operators">Text Search Functions and Operators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/functions/range-functions-and-operators">Range Functions and Operators</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/docs/sys-utilities/">系统工具</a><button aria-label="展开侧边栏分类 &#x27;系统工具&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/releases/">版本发布说明</a><button aria-label="展开侧边栏分类 &#x27;版本发布说明&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_hjYf"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Alpn" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/zh/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_xK9p"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link" id="支付">参考指南</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><span class="breadcrumbs__link" style="cursor:pointer">Built-in Functions</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">JSON Functions and Operators</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_bxCs"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>JSON Functions and Operators in Cloudberry Database</h1>
<p>This document describes:</p>
<ul>
<li>functions and operators for processing and creating JSON data</li>
<li>the SQL/JSON path language</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="process-and-creating-json-data">Process and creating JSON data<a href="#process-and-creating-json-data" class="hash-link" aria-label="Process and creating JSON data的直接链接" title="Process and creating JSON data的直接链接">​</a></h2>
<p>Cloudberry Database includes built-in functions and operators that create and manipulate JSON data:</p>
<ul>
<li><a href="#json-operators">JSON operators</a></li>
<li><a href="#json-creation-functions">JSON creation functions</a></li>
<li><a href="#json-aggregate-functions">JSON aggregate functions</a></li>
<li><a href="#json-processing-functions">JSON processing functions</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="json-operators">JSON operators<a href="#json-operators" class="hash-link" aria-label="JSON operators的直接链接" title="JSON operators的直接链接">​</a></h3>
<p>This table describes the operators that are available for use with the <code>json</code> and <code>jsonb</code> data types.</p>
<table><thead><tr><th>Operator</th><th>Right Operand Type</th><th>Return Type</th><th>Description</th><th>Example</th><th>Example Result</th></tr></thead><tbody><tr><td><code>-&gt;</code></td><td><code>int</code></td><td><code>json</code> or <code>jsonb</code></td><td>Get the JSON array element (indexed from zero, negative integers count from the end).</td><td><code>&#x27;[{&quot;a&quot;:&quot;foo&quot;},{&quot;b&quot;:&quot;bar&quot;},{&quot;c&quot;:&quot;baz&quot;}]&#x27;::json-&gt;2</code></td><td><code>{&quot;c&quot;:&quot;baz&quot;}</code></td></tr><tr><td><code>-&gt;</code></td><td><code>text</code></td><td><code>json</code> or <code>jsonb</code></td><td>Get the JSON object field by key.</td><td><code>&#x27;{&quot;a&quot;: {&quot;b&quot;:&quot;foo&quot;}}&#x27;::json-&gt;&#x27;a&#x27;</code></td><td><code>{&quot;b&quot;:&quot;foo&quot;}</code></td></tr><tr><td><code>-&gt;&gt;</code></td><td><code>int</code></td><td><code>text</code></td><td>Get the JSON array element as <code>text</code>.</td><td><code>&#x27;[1,2,3]&#x27;::json-&gt;&gt;2</code></td><td><code>3</code></td></tr><tr><td><code>-&gt;&gt;</code></td><td><code>text</code></td><td><code>text</code></td><td>Get the JSON object field as <code>text</code>.</td><td><code>&#x27;{&quot;a&quot;:1,&quot;b&quot;:2}&#x27;::json-&gt;&gt;&#x27;b&#x27;</code></td><td><code>2</code></td></tr><tr><td><code>#&gt;</code></td><td><code>text[]</code></td><td><code>json</code> or <code>jsonb</code></td><td>Get the JSON object at the specified path.</td><td><code>&#x27;{&quot;a&quot;: {&quot;b&quot;:{&quot;c&quot;: &quot;foo&quot;}}}&#x27;::json#&gt;&#x27;{a,b}</code>&#x27;</td><td><code>{&quot;c&quot;: &quot;foo&quot;}</code></td></tr><tr><td><code>#&gt;&gt;</code></td><td><code>text[]</code></td><td><code>text</code></td><td>Get the JSON object at the specified path as <code>text</code>.</td><td><code>&#x27;{&quot;a&quot;:[1,2,3],&quot;b&quot;:[4,5,6]}&#x27;::json#&gt;&gt;&#x27;{a,2}&#x27;</code></td><td><code>3</code></td></tr></tbody></table>
<blockquote>
<p><strong>Note</strong> There are parallel variants of these operators for both the <code>json</code> and <code>jsonb</code> data types. The field/element/path extraction operators return the same data type as their left-hand input (either <code>json</code> or <code>jsonb</code>), except for those specified as returning <code>text</code>, which coerce the value to <code>text</code>. The field/element/path extraction operators return <code>NULL</code>, rather than failing, if the JSON input does not have the right structure to match the request; for example if no such element exists. The field/element/path extraction operators that accept integer JSON array subscripts all support negative subscripting from the end of arrays.</p>
</blockquote>
<p>These standard comparison operators are available for <code>jsonb</code>, but not for <code>json.</code> They follow the ordering rules for B-tree operations outlined at jsonb Indexing.</p>
<table><thead><tr><th>Operator</th><th>Description</th></tr></thead><tbody><tr><td><code>&lt;</code></td><td>less than</td></tr><tr><td><code>&gt;</code></td><td>greater than</td></tr><tr><td><code>&lt;=</code></td><td>less than or equal to</td></tr><tr><td><code>&gt;=</code></td><td>greater than or equal to</td></tr><tr><td><code>=</code></td><td>equal</td></tr><tr><td><code>&lt;&gt;</code> or <code>!=</code></td><td>not equal</td></tr></tbody></table>
<blockquote>
<p><strong>Note</strong> The <code>!=</code> operator is converted to <code>&lt;&gt;</code> in the parser stage. It is not possible to implement <code>!=</code> and <code>&lt;&gt;</code> operators that do different things.</p>
</blockquote>
<p>Operators that require the <code>jsonb</code> data type as the left operand are described in the following table. Many of these operators can be indexed by <code>jsonb</code> operator classes.</p>
<table><thead><tr><th>Operator</th><th>Right Operand Type</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td><code>@&gt;</code></td><td><code>jsonb</code></td><td>Does the left JSON value contain the right JSON path/value entries at the top level?</td><td><code>&#x27;{&quot;a&quot;:1, &quot;b&quot;:2}&#x27;::jsonb @&gt; &#x27;{&quot;b&quot;:2}&#x27;::jsonb</code></td></tr><tr><td><code>&lt;@</code></td><td><code>jsonb</code></td><td>Are the left JSON path/value enries contained at the top level within the right JSON value?</td><td><code>&#x27;{&quot;b&quot;:2}&#x27;::jsonb &lt;@ &#x27;{&quot;a&quot;:1, &quot;b&quot;:2}&#x27;::jsonb</code></td></tr><tr><td><code>?</code></td><td><code>text</code></td><td>Does the <em>string</em> exist as a top-level key within the JSON value?</td><td><code>&#x27;{&quot;a&quot;:1, &quot;b&quot;:2}&#x27;::jsonb ? &#x27;b&#x27;</code></td></tr><tr><td><code>?|</code></td><td><code>text[]</code></td><td>Do any of these array <em>strings</em> exist as a top-level key?</td><td><code>&#x27;{&quot;a&quot;:1, &quot;b&quot;:2, &quot;c&quot;:3}&#x27;::jsonb ?| array[&#x27;b&#x27;, &#x27;c&#x27;]</code></td></tr><tr><td><code>?&amp;</code></td><td><code>text[]</code></td><td>Do all of these array <em>strings</em> exist as top-level keys?</td><td><code>&#x27;[&quot;a&quot;, &quot;b&quot;]&#x27;::jsonb ?&amp; array[&#x27;a&#x27;, &#x27;b&#x27;]</code></td></tr><tr><td><code>||</code></td><td><code>jsonb</code></td><td>Concatenate two <code>jsonb</code> values into a new <code>jsonb</code> value.</td><td><code>&#x27;[&quot;a&quot;, &quot;b&quot;]&#x27;::jsonb || &#x27;[&quot;c&quot;, &quot;d&quot;]&#x27;::jsonb</code></td></tr><tr><td><code>-</code></td><td><code>text</code></td><td>Delete key/value pair or <em>string</em> elements from left operand. Key/value pairs are matched based on their key value.</td><td><code>&#x27;{&quot;a&quot;: &quot;b&quot;}&#x27;::jsonb - &#x27;a&#x27;</code></td></tr><tr><td><code>-</code></td><td><code>text[]</code></td><td>Delete multiple key/value pairs or <em>string</em> elements from left operand. Key/value pairs are matched based on their key value.</td><td><code>&#x27;{&quot;a&quot;: &quot;b&quot;, &quot;c&quot;: &quot;d&quot;}&#x27;::jsonb - &#x27;{a,c}&#x27;::text[]</code></td></tr><tr><td><code>-</code></td><td><code>integer</code></td><td>Delete the array element with specified index (Negative integers count from the end). Throws an error if top level container is not an array.</td><td><code>&#x27;[&quot;a&quot;, &quot;b&quot;]&#x27;::jsonb - 1</code></td></tr><tr><td><code>#-</code></td><td><code>text[]</code></td><td>Delete the field or element with specified path (for JSON arrays, negative integers count from the end)</td><td><code>&#x27;[&quot;a&quot;, {&quot;b&quot;:1}]&#x27;::jsonb #- &#x27;{1,b}&#x27;</code></td></tr><tr><td><code>@?</code></td><td><code>jsonpath</code></td><td>Does JSON path return any item for the specified JSON value?</td><td><code>&#x27;{&quot;a&quot;:[1,2,3,4,5]}&#x27;::jsonb @? &#x27;$.a[*] ? (@ &gt; 2)&#x27;</code></td></tr><tr><td><code>@@</code></td><td><code>jsonpath</code></td><td>Returns the result of JSON path predicate check for the specified JSON value. Only the first item of the result is taken into account. If the result is not Boolean, then <code>null</code> is returned.</td><td><code>&#x27;{&quot;a&quot;:[1,2,3,4,5]}&#x27;::jsonb @@ &#x27;$.a[*] &gt; 2&#x27;</code></td></tr></tbody></table>
<blockquote>
<p><strong>Note</strong>  The <code>||</code> operator concatenates two JSON objects by generating an object containing the union of their keys, taking the second object&#x27;s value when there are duplicate keys. All other cases produce a JSON array: first, any non-array input is converted into a single-element array, and then the two arrays are concatenated. It does not operate recursively; only the top-level array or object structure is merged.</p>
</blockquote>
<blockquote>
<p><strong>Note</strong>  The <code>@?</code> and <code>@@</code> operators suppress the following errors: lacking object field or array element, unexpected JSON item type, and numeric errors. This behavior might be helpful while searching over JSON document collections of varying structure.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="json-creation-functions">JSON creation functions<a href="#json-creation-functions" class="hash-link" aria-label="JSON creation functions的直接链接" title="JSON creation functions的直接链接">​</a></h3>
<p>This table describes the functions that create <code>json</code> and <code>jsonb</code> data type values. (There are no equivalent functions for <code>jsonb</code> for <code>row_to_json()</code> and <code>array_to_json()</code>. However, the <code>to_jsonb()</code> function supplies much the same functionality as these functions would.)</p>
<table><thead><tr><th>Function</th><th>Description</th><th>Example</th><th>Example Result</th></tr></thead><tbody><tr><td><code>to_json(anyelement)</code> <br> <code>to_jsonb(anyelement)</code></td><td>Returns the value as a <code>json</code> or <code>jsonb</code> object. Arrays and composites are converted (recursively) to arrays and objects; otherwise, if the input contains a cast from the type to <code>json</code>, the cast function is used to perform the conversion; otherwise, a scalar value is produced. For any scalar type other than a number, a Boolean, or a null value, the text representation will be used, in such a fashion that it is a valid <code>json</code> or <code>jsonb</code> value.</td><td><code>to_json(&#x27;Fred said &quot;Hi.&quot;&#x27;::text)</code></td><td><code>&quot;Fred said &quot;Hi.&quot;&quot;</code></td></tr><tr><td><code>array_to_json(anyarray [, pretty_bool])</code></td><td>Returns the array as a JSON array. A multidimensional array becomes a JSON array of arrays. Line feeds will be added between dimension-1 elements if <code>pretty_bool</code> is true.</td><td><code>array_to_json(&#x27;{{1,5},{99,100}}&#x27;::int[])</code></td><td><code>[[1,5],[99,100]]</code></td></tr><tr><td><code>row_to_json(record [, pretty_bool])</code></td><td>Returns the row as a JSON object. Line feeds will be added between level-1 elements if <code>pretty_bool</code> is true.</td><td><code>row_to_json(row(1,&#x27;foo&#x27;))</code></td><td><code>{&quot;f1&quot;:1,&quot;f2&quot;:&quot;foo&quot;}</code></td></tr><tr><td><code>json_build_array(VARIADIC &quot;any&quot;)</code> <br> <code>jsonb_build_array(VARIADIC &quot;any&quot;)</code></td><td>Builds a possibly-heterogeneously-typed JSON array out of a <code>VARIADIC</code> argument list.</td><td><code>json_build_array(1,2,&#x27;3&#x27;,4,5)</code></td><td><code>[1, 2, &quot;3&quot;, 4, 5]</code></td></tr><tr><td><code>json_build_object(VARIADIC &quot;any&quot;)</code> <br> <code>jsonb_build_object(VARIADIC &quot;any&quot;)</code></td><td>Builds a JSON object out of a <code>VARIADIC</code> argument list. The argument list is taken in order and converted to a set of key/value pairs.</td><td><code>json_build_object(&#x27;foo&#x27;,1,&#x27;bar&#x27;,2)</code></td><td><code>{&quot;foo&quot;: 1, &quot;bar&quot;: 2}</code></td></tr><tr><td><code>json_object(text[])</code><br><code>jsonb_object(text[])</code></td><td>Builds a JSON object out of a text array. The array must have either exactly one dimension with an even number of members, in which case they are taken as alternating key/value pairs, or two dimensions such that each inner array has exactly two elements, which are taken as a key/value pair.</td><td><code>json_object(&#x27;{a, 1, b, &quot;def&quot;, c, 3.5}&#x27;)</code> <br><br> <code>json_object(&#x27;{{a, 1},{b, &quot;def&quot;},{c, 3.5}}&#x27;)</code></td><td><code>{&quot;a&quot;: &quot;1&quot;, &quot;b&quot;: &quot;def&quot;, &quot;c&quot;: &quot;3.5&quot;}</code></td></tr><tr><td><code>json_object(keys text[], values text[])</code> <br> <code>jsonb_object(keys text[], values text[])</code></td><td>Builds a JSON object out of a text array. This form of <code>json_object</code> takes keys and values pairwise from two separate arrays. In all other respects it is identical to the one-argument form.</td><td><code>json_object(&#x27;{a, b}&#x27;, &#x27;{1,2}&#x27;)</code></td><td><code>{&quot;a&quot;: &quot;1&quot;, &quot;b&quot;: &quot;2&quot;}</code></td></tr></tbody></table>
<blockquote>
<p><strong>Note</strong> <code>array_to_json()</code> and <code>row_to_json()</code> have the same behavior as <code>to_json()</code> except for offering a pretty-printing option. The behavior described for <code>to_json()</code> likewise applies to each individual value converted by the other JSON creation functions.</p>
</blockquote>
<blockquote>
<p><strong>Note</strong> The hstore extension has a cast from <code>hstore</code> to <code>json</code>, so that <code>hstore</code> values converted via the JSON creation functions will be represented as JSON objects, not as primitive string values.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="json-aggregate-functions">JSON aggregate functions<a href="#json-aggregate-functions" class="hash-link" aria-label="JSON aggregate functions的直接链接" title="JSON aggregate functions的直接链接">​</a></h3>
<p>This table shows the functions that aggregate records to an array of JSON objects and pairs of values to a JSON object</p>
<table><thead><tr><th>Function</th><th>Argument Types</th><th>Return Type</th><th>Description</th></tr></thead><tbody><tr><td><code>json_agg(record)</code> <br> <code>jsonb_agg(record)</code></td><td><code>record</code></td><td><code>json</code></td><td>Aggregates records as a JSON array of objects.</td></tr><tr><td><code>json_object_agg(name, value)</code> <br> <code>jsonb_object_agg(name, value)</code></td><td><code>(&quot;any&quot;, &quot;any&quot;)</code></td><td><code>json</code></td><td>Aggregates name/value pairs as a JSON object.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sqljson-path-language">SQL/JSON path language<a href="#sqljson-path-language" class="hash-link" aria-label="SQL/JSON path language的直接链接" title="SQL/JSON path language的直接链接">​</a></h3>
<p>SQL/JSON path expressions specify the items to be retrieved from the JSON data, similar to XPath expressions used for SQL access to XML. In Cloudberry Database, path expressions are implemented as the <code>jsonpath</code> data type.</p>
<p>JSON query functions and operators pass the provided path expression to the <em>path engine</em> for evaluation. If the expression matches the queried JSON data, the corresponding SQL/JSON item is returned. Path expressions are written in the SQL/JSON path language and can also include arithmetic expressions and functions. Query functions treat the provided expression as a text string, so it must be enclosed in single quotes.</p>
<p>A path expression consists of a sequence of elements allowed by the <code>jsonpath</code> data type. The path expression is evaluated from left to right, but you can use parentheses to change the order of operations. If the evaluation is successful, a sequence of SQL/JSON items (<em>SQL/JSON sequence</em>) is produced, and the evaluation result is returned to the JSON query function that completes the specified computation.</p>
<p>To refer to the JSON data to be queried (the <em>context item</em>), use the <code>$</code> sign in the path expression. It can be followed by one or more accessor operators, which go down the JSON structure level by level to retrieve the content of context item. Each operator that follows deals with the result of the previous evaluation step.</p>
<p>For example, suppose you have some JSON data from a GPS tracker that you would like to parse, such as:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;track&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;segments&quot;: [</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;location&quot;:   [ 47.763, 13.4034 ],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;start time&quot;: &quot;2018-10-14 10:05:14&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;HR&quot;: 73</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;location&quot;:   [ 47.706, 13.2635 ],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;start time&quot;: &quot;2018-10-14 10:39:21&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;HR&quot;: 135</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To retrieve the available track segments, you need to use the <code>.&lt;key&gt;</code> accessor operator for all the preceding JSON objects:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;$.track.segments&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the item to retrieve is an element of an array, you have to unnest this array using the <code>[*]</code> operator. For example, the following path will return location coordinates for all the available track segments:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;$.track.segments[*].location&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To return the coordinates of the first segment only, you can specify the corresponding subscript in the <code>[]</code> accessor operator. Note that the SQL/JSON arrays are 0-relative:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;$.track.segments[0].location&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The result of each path evaluation step can be processed by one or more <code>jsonpath</code> operators and methods listed in <a href="#sqljson-path-operators-and-methods">SQL/JSON Path Operators and Methods</a> below. Each method name must be preceded by a dot. For example, you can get an array size:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;$.track.segments.size()&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more examples of using <code>jsonpath</code> operators and methods within path expressions, see <a href="#sqljson-path-operators-and-methods">SQL/JSON Path Operators and Methods</a> below.</p>
<p>When defining the path, you can also use one or more <em>filter expressions</em> that work similar to the <code>WHERE</code> clause in SQL. A filter expression begins with a question mark and provides a condition in parentheses:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">? (condition)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Filter expressions must be specified right after the path evaluation step to which they are applied. The result of this step is filtered to include only those items that satisfy the provided condition. SQL/JSON defines three-valued logic, so the condition can be <code>true</code>, <code>false</code>, or <code>unknown</code>. The <code>unknown</code> value plays the same role as SQL <code>NULL</code> and can be tested for with the is <code>unknown</code> predicate. Further path evaluation steps use only those items for which filter expressions return <code>true</code>.</p>
<p>Functions and operators that can be used in filter expressions are listed in <a href="#sqljson-filter-expression-elements">jsonpath Filter Expression Elements</a>. The path evaluation result to be filtered is denoted by the <code>@</code> variable. To refer to a JSON element stored at a lower nesting level, add one or more accessor operators after <code>@</code>.</p>
<p>Suppose you would like to retrieve all heart rate values higher than 130. You can achieve this using the following expression:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;$.track.segments[*].HR ? (@ &gt; 130)&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To get the start time of segments with such values instead, you have to filter out irrelevant segments before returning the start time, so the filter expression is applied to the previous step, and the path used in the condition is different:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;$.track.segments[*] ? (@.HR &gt; 130).&quot;start time&quot;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can use several filter expressions on the same nesting level, if required. For example, the following expression selects all segments that contain locations with relevant coordinates and high heart rate values:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;$.track.segments[*] ? (@.location[1] &lt; 13.4) ? (@.HR &gt; 130).&quot;start time&quot;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Using filter expressions at different nesting levels is also allowed. The following example first filters all segments by location, and then returns high heart rate values for these segments, if available:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;$.track.segments[*] ? (@.location[1] &lt; 13.4).HR ? (@ &gt; 130)&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can also nest filter expressions within each other:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;$.track ? (exists(@.segments[*] ? (@.HR &gt; 130))).segments.size()&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This expression returns the size of the track if it contains any segments with high heart rate values, or an empty sequence otherwise.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deviations-from-standard">Deviations from standard<a href="#deviations-from-standard" class="hash-link" aria-label="Deviations from standard的直接链接" title="Deviations from standard的直接链接">​</a></h3>
<p>Cloudberry Database&#x27;s implementation of SQL/JSON path language has the following deviations from the SQL/JSON standard:</p>
<ul>
<li>
<p><code>.datetime()</code> item method is not implemented yet mainly because immutable <code>jsonpath</code> functions and operators cannot reference session timezone, which is used in some datetime operations. Datetime support will be added to <code>jsonpath</code> in future versions of Cloudberry Database.</p>
</li>
<li>
<p>A path expression can be a Boolean predicate, although the SQL/JSON standard allows predicates only in filters. This is necessary for implementation of the <code>@@</code> operator. For example, the following <code>jsonpath</code> expression is valid in Cloudberry Database:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;$.track.segments[*].HR &lt; 70&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>There are minor differences in the interpretation of regular expression patterns used in <code>like_regex</code> filters as described in <a href="#regular-expressions">Regular expressions</a>.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="strict-and-lax-modes">Strict and lax modes<a href="#strict-and-lax-modes" class="hash-link" aria-label="Strict and lax modes的直接链接" title="Strict and lax modes的直接链接">​</a></h3>
<p>When you query JSON data, the path expression may not match the actual JSON data structure. An attempt to access a non-existent member of an object or element of an array results in a structural error. SQL/JSON path expressions have two modes of handling structural errors:</p>
<ul>
<li>
<p>lax (default) — the path engine implicitly adapts the queried data to the specified path. Any remaining structural errors are suppressed and converted to empty SQL/JSON sequences.</p>
</li>
<li>
<p>strict — if a structural error occurs, an error is raised.</p>
</li>
</ul>
<p>The lax mode facilitates matching of a JSON document structure and path expression if the JSON data does not conform to the expected schema. If an operand does not match the requirements of a particular operation, it can be automatically wrapped as an SQL/JSON array or unwrapped by converting its elements into an SQL/JSON sequence before performing this operation. Besides, comparison operators automatically unwrap their operands in the lax mode, so you can compare SQL/JSON arrays out-of-the-box. An array of size 1 is considered equal to its sole element. Automatic unwrapping is not performed only when:</p>
<ul>
<li>
<p>The path expression contains <code>type()</code> or <code>size()</code> methods that return the type and the number of elements in the array, respectively.</p>
</li>
<li>
<p>The queried JSON data contain nested arrays. In this case, only the outermost array is unwrapped, while all the inner arrays remain unchanged. Thus, implicit unwrapping can only go one level down within each path evaluation step.</p>
</li>
</ul>
<p>For example, when querying the GPS data listed above, you can abstract from the fact that it stores an array of segments when using the lax mode:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;lax $.track.segments.location&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In the strict mode, the specified path must exactly match the structure of the queried JSON document to return an SQL/JSON item, so using this path expression will cause an error. To get the same result as in the lax mode, you have to explicitly unwrap the segments array:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;strict $.track.segments[*].location&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>.**</code> accessor can lead to surprising results when using the lax mode. For instance, the following query selects every HR value twice:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">lax $.**.HR</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This happens because the <code>.**</code> accessor selects both the segments array and each of its elements, while the <code>.HR</code> accessor automatically unwraps arrays when using the lax mode. To avoid surprising results, we recommend using the <code>.**</code> accessor only in the strict mode. The following query selects each HR value just once:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">strict $.**.HR</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="regular-expressions">Regular expressions<a href="#regular-expressions" class="hash-link" aria-label="Regular expressions的直接链接" title="Regular expressions的直接链接">​</a></h3>
<p>SQL/JSON path expressions allow matching text to a regular expression with the <code>like_regex</code> filter. For example, the following SQL/JSON path query would case-insensitively match all strings in an array that starts with an English vowel:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;$[*] ? (@ like_regex &quot;^[aeiou]&quot; flag &quot;i&quot;)&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The optional flag string may include one or more of the characters <code>i</code> for case-insensitive match, <code>m</code> to allow <code>^</code> and <code>$</code> to match at newlines, <code>s</code> to allow <code>.</code> to match a newline, and <code>q</code> to quote the whole pattern (reducing the behavior to a simple substring match).</p>
<p>The SQL/JSON standard borrows its definition for regular expressions from the <code>LIKE_REGEX</code> operator, which in turn uses the XQuery standard. Cloudberry Database does not currently support the <code>LIKE_REGEX</code> operator. Therefore, the <code>like_regex</code> filter is implemented using the POSIX regular expression engine as described in <a href="https://www.postgresql.org/docs/12/functions-matching.html#FUNCTIONS-POSIX-REGEXP" target="_blank" rel="noopener noreferrer">POSIX Regular Expressions</a>. This leads to various minor discrepancies from standard SQL/JSON behavior which are catalogued in <a href="https://www.postgresql.org/docs/12/functions-matching.html#POSIX-VS-XQUERY" target="_blank" rel="noopener noreferrer">Differences From XQuery (LIKE_REGEX)</a>. Note, however, that the flag-letter incompatibilities described there do not apply to SQL/JSON, as it translates the XQuery flag letters to match what the POSIX engine expects.</p>
<p>Keep in mind that the pattern argument of <code>like_regex</code> is a JSON path string literal, written according to the rules given in jsonpath Type. This means in particular that any backslashes you want to use in the regular expression must be doubled. For example, to match string values of the root document that contain only digits:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$.* ? (@ like_regex &quot;^\\d+$&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sqljson-path-operators-and-methods">SQL/JSON path operators and methods<a href="#sqljson-path-operators-and-methods" class="hash-link" aria-label="SQL/JSON path operators and methods的直接链接" title="SQL/JSON path operators and methods的直接链接">​</a></h3>
<p>The following table describes the operators and methods available in <code>jsonpath</code>:</p>
<table><thead><tr><th>Operator/Method</th><th>Description</th><th>Example JSON</th><th>Example Query</th><th>Result</th></tr></thead><tbody><tr><td><code>+</code> (unary)</td><td>Plus operator that iterates over the SQL/JSON sequence</td><td><code>{&quot;x&quot;: [2.85, -14.7, -9.4]}</code></td><td><code>+ $.x.floor()</code></td><td><code>2, -15, -10</code></td></tr><tr><td><code>-</code> (unary)</td><td>Minus operator that iterates over the SQL/JSON sequence</td><td><code>{&quot;x&quot;: [2.85, -14.7, -9.4]}</code></td><td><code>- $.x.floor()</code></td><td><code>-2, 15, 10</code></td></tr><tr><td><code>+</code> (binary)</td><td>Addition</td><td><code>[2]</code></td><td><code>2 + $[0]</code></td><td><code>4</code></td></tr><tr><td><code>-</code> (binary)</td><td>Subtraction</td><td><code>[2]</code></td><td><code>4 - $[0]</code></td><td><code>2</code></td></tr><tr><td><code>*</code></td><td>Multiplication</td><td><code>[4]</code></td><td><code>2 * $[0]</code></td><td><code>8</code></td></tr><tr><td><code>/</code></td><td>Division</td><td><code>[8]</code></td><td><code>$[0] / 2</code></td><td><code>4</code></td></tr><tr><td><code>%</code></td><td>Modulus</td><td><code>[32]</code></td><td><code>$[0] % 10</code></td><td><code>2</code></td></tr><tr><td><code>type()</code></td><td>Type of the SQL/JSON item</td><td><code>[1, &quot;2&quot;, {}]</code></td><td><code>$[*].type()</code></td><td><code>&quot;number&quot;, &quot;string&quot;, &quot;object&quot;</code></td></tr><tr><td><code>size()</code></td><td>Size of the SQL/JSON item</td><td><code>{&quot;m&quot;: [11, 15]}</code></td><td><code>$.m.size()</code></td><td><code>2</code></td></tr><tr><td><code>double()</code></td><td>Approximate floating-point number converted from an SQL/JSON number or a string</td><td><code>{&quot;len&quot;: &quot;1.9&quot;}</code></td><td><code>$.len.double() * 2</code></td><td><code>3.8</code></td></tr><tr><td><code>ceiling()</code></td><td>Nearest integer greater than or equal to the SQL/JSON number</td><td><code>{&quot;h&quot;: 1.3}</code></td><td><code>$.h.ceiling()</code></td><td><code>2</code></td></tr><tr><td><code>floor()</code></td><td>Nearest integer less than or equal to the SQL/JSON number</td><td><code>{&quot;h&quot;: 1.3}</code></td><td><code>$.h.floor()</code></td><td><code>1</code></td></tr><tr><td><code>abs()</code></td><td>Absolute value of the SQL/JSON number</td><td><code>{&quot;z&quot;: -0.3}</code></td><td><code>$.z.abs()</code></td><td><code>0.3</code></td></tr><tr><td><code>keyvalue()</code></td><td>Sequence of object&#x27;s key-value pairs represented as array of items containing three fields (<code>&quot;key&quot;</code>, <code>&quot;value&quot;</code>, and <code>&quot;id&quot;</code>). <code>&quot;id&quot;</code> is a unique identifier of the object key-value pair belongs to.</td><td><code>{&quot;x&quot;: &quot;20&quot;, &quot;y&quot;: 32}</code></td><td><code>$.keyvalue()</code></td><td><code>{&quot;key&quot;: &quot;x&quot;, &quot;value&quot;: &quot;20&quot;, &quot;id&quot;: 0}, {&quot;key&quot;: &quot;y&quot;, &quot;value&quot;: 32, &quot;id&quot;: 0}</code></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sqljson-filter-expression-elements">SQL/JSON filter expression elements<a href="#sqljson-filter-expression-elements" class="hash-link" aria-label="SQL/JSON filter expression elements的直接链接" title="SQL/JSON filter expression elements的直接链接">​</a></h3>
<p>The following table describes the available filter expressions elements for <code>jsonpath</code>:</p>
<table><thead><tr><th>Value/Predicate</th><th>Description</th><th>Example JSON</th><th>Example Query</th><th>Result</th></tr></thead><tbody><tr><td><code>==</code></td><td>Equality operator</td><td><code>[1, 2, 1, 3]</code></td><td><code>$[*] ? (@ == 1)</code></td><td><code>1, 1</code></td></tr><tr><td><code>!=</code></td><td>Non-equality operator</td><td><code>[1, 2, 1, 3]</code></td><td><code>$[*] ? (@ != 1)</code></td><td><code>2, 3</code></td></tr><tr><td><code>&lt;&gt;</code></td><td>Non-equality operator (same as <code>!=</code>)</td><td><code>[1, 2, 1, 3]</code></td><td><code>$[*] ? (@ &lt;&gt; 1)</code></td><td><code>2, 3</code></td></tr><tr><td><code>&lt;</code></td><td>Less-than operator</td><td><code>[1, 2, 3]</code></td><td><code>$[*] ? (@ &lt; 2)</code></td><td><code>1</code></td></tr><tr><td><code>&lt;=</code></td><td>Less-than-or-equal-to operator</td><td><code>[1, 2, 3]</code></td><td><code>$[*] ? (@ &lt;= 2)</code></td><td><code>1, 2</code></td></tr><tr><td><code>&gt;</code></td><td>Greater-than operator</td><td><code>[1, 2, 3]</code></td><td><code>$[*] ? (@ &gt; 2)</code></td><td><code>3</code></td></tr><tr><td><code>&gt;=</code></td><td>Greater-than-or-equal-to operator</td><td><code>[1, 2, 3]</code></td><td><code>$[*] ? (@ &gt;= 2)</code></td><td><code>2, 3</code></td></tr><tr><td><code>true</code></td><td>Value used to perform comparison with JSON <code>true</code> literal</td><td><code>[{&quot;name&quot;: &quot;John&quot;, &quot;parent&quot;: false}, {&quot;name&quot;: &quot;Chris&quot;, &quot;parent&quot;: true}]</code></td><td><code>$[*] ? (@.parent == true)</code></td><td><code>{&quot;name&quot;: &quot;Chris&quot;, &quot;parent&quot;: true}</code></td></tr><tr><td><code>false</code></td><td>Value used to perform comparison with JSON <code>false</code> literal</td><td><code>[{&quot;name&quot;: &quot;John&quot;, &quot;parent&quot;: false}, {&quot;name&quot;: &quot;Chris&quot;, &quot;parent&quot;: true}]</code></td><td><code>$[*] ? (@.parent == false)</code></td><td><code>{&quot;name&quot;: &quot;John&quot;, &quot;parent&quot;: false}</code></td></tr><tr><td><code>null</code></td><td>Value used to perform comparison with JSON <code>null</code> value</td><td><code>[{&quot;name&quot;: &quot;Mary&quot;, &quot;job&quot;: null}, {&quot;name&quot;: &quot;Michael&quot;, &quot;job&quot;: &quot;driver&quot;}]</code></td><td><code>$[*] ? (@.job == null) .name</code></td><td><code>&quot;Mary&quot;</code></td></tr><tr><td><code>&amp;&amp;</code></td><td>Boolean AND</td><td><code>[1, 3, 7]</code></td><td><code>$[*] ? (@ &gt; 1 &amp;&amp; @ &lt; 5)</code></td><td><code>3</code></td></tr><tr><td><code>||</code></td><td>Boolean OR</td><td><code>[1, 3, 7]</code></td><td><code>$[*] ? (@ &lt; 1 || @ &gt; 5)</code></td><td><code>7</code></td></tr><tr><td><code>!</code></td><td>Boolean NOT</td><td><code>[1, 3, 7]</code></td><td><code>$[*] ? (!(@ &lt; 5))</code></td><td><code>7</code></td></tr><tr><td><code>like_regex</code></td><td>Tests whether the first operand matches the regular expression given by the second operand, optionally with modifications described by a string of <code>flag</code> characters.</td><td><code>[&quot;abc&quot;, &quot;abd&quot;, &quot;aBdC&quot;, &quot;abdacb&quot;, &quot;babc&quot;]</code></td><td><code>$[*] ? (@ like_regex &quot;^ab.*c&quot; flag &quot;i&quot;)</code></td><td><code>&quot;abc&quot;, &quot;aBdC&quot;, &quot;abdacb&quot;</code></td></tr><tr><td><code>starts with</code></td><td>Tests whether the second operand is an initial substring of the first operand</td><td><code>[&quot;John Smith&quot;, &quot;Mary Stone&quot;, &quot;Bob Johnson&quot;]</code></td><td><code>$[*] ? (@ starts with &quot;John&quot;)</code></td><td><code>&quot;John Smith&quot;</code></td></tr><tr><td><code>exists</code></td><td>Tests whether a path expression matches at least one SQL/JSON item</td><td><code>{&quot;x&quot;: [1, 2], &quot;y&quot;: [2, 4]}</code></td><td><code>strict $.* ? (exists (@ ? (@[*] &gt; 2)))</code></td><td><code>2, 4</code></td></tr><tr><td><code>is unknown</code></td><td>Tests whether a Boolean condition is <code>unknown</code></td><td><code>[-1, 2, 7, &quot;infinity&quot;]</code></td><td><code>$[*] ? ((@ &gt; 0) is unknown)</code></td><td><code>&quot;infinity&quot;</code></td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/cloudberry-site/edit/main/docs/functions/json-functions-and-operators.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_VsjB"><span class="theme-last-updated">最后<!-- -->由 <b>Ed Espino</b> <!-- -->于 <b><time datetime="2024-11-28T03:20:09.000Z">2024年11月28日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh/docs/functions/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label single-line-overflow hide-before-after">Summary of Built-in Functions</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh/docs/functions/window-functions"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label single-line-overflow hide-before-after">Window Functions</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_jeP5 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#process-and-creating-json-data" class="table-of-contents__link toc-highlight">Process and creating JSON data</a></li></ul></div></div></div></div></main></div></div></div><div class="wrap_QlFE"><div class="mainWrap_IbWk"><div class="linksWrap_Zcc4"><div><div class="footerLinkTitle_PxTg">Support</div><div class="footerLinkItem_Kf4k"><a href="https://github.com/apache/cloudberry/issues" target="_blank" rel="noopener noreferrer">GitHub Issues</a></div><div class="footerLinkItem_Kf4k"><a href="https://github.com/apache/cloudberry/discussions" target="_blank" rel="noopener noreferrer">GitHub Discussions</a></div><div class="footerLinkItem_Kf4k"><a href="https://inviter.co/apache-cloudberry" target="_blank" rel="noopener noreferrer">Slack</a></div><div class="footerLinkItem_Kf4k"><a href="https://x.com/ASFCloudberry" target="_blank" rel="noopener noreferrer">Twitter</a></div><div class="footerLinkItem_Kf4k"><a href="https://youtube.com/@ApacheCloudberry" target="_blank" rel="noopener noreferrer">Youtube</a></div><div class="footerLinkItem_Kf4k"><a target="_self" href="/zh/community/security">Security</a></div></div><div><div class="footerLinkTitle_PxTg">Resources</div><div class="footerLinkItem_Kf4k"><a href="https://github.com/apache/cloudberry/releases" target="_blank" rel="noopener noreferrer">Download</a></div><div class="footerLinkItem_Kf4k"><a target="_self" href="/zh/docs/">Documentation</a></div><div class="footerLinkItem_Kf4k"><a target="_self" href="/zh/community/events">Events</a></div><div class="footerLinkItem_Kf4k"><a href="/zh/community/coc" target="_blank">Code of Conduct</a></div><div class="footerLinkItem_Kf4k"><a href="/zh/community/brand" target="_blank">Brand Guidelines</a></div></div><div><div class="footerLinkTitle_PxTg">Contribution</div><div class="footerLinkItem_Kf4k"><a target="_self" href="/zh/contribute/git">Working with Git &amp; GitHub</a></div><div class="footerLinkItem_Kf4k"><a target="_self" href="/zh/contribute/how-to-contribute">Contribution Overview</a></div><div class="footerLinkItem_Kf4k"><a target="_self" href="/zh/contribute/code">Code Contribution</a></div><div class="footerLinkItem_Kf4k"><a target="_self" href="/zh/contribute/doc">Doc Contribution</a></div></div></div><div class="logoLinkWrap_MDp5"><div class="logoWrap_qcVI"><img class="logo_cphB" src="/zh/img/apache-incubator.svg" alt=""><img class="swap_mytH" src="/zh/img/en_zh.png" alt=""></div><div class="links_yA93"><svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg" class="item_KKoc" cursor="pointer"><path d="M15.002 0c-8.288 0-15 6.713-15 15 0 6.637 4.293 12.244 10.256 14.231.75.131 1.031-.319 1.031-.712 0-.356-.019-1.538-.019-2.794-3.769.694-4.744-.919-5.044-1.763-.168-.43-.9-1.762-1.537-2.118-.525-.282-1.275-.975-.019-.994 1.181-.019 2.025 1.087 2.306 1.537 1.35 2.27 3.507 1.632 4.37 1.238.13-.975.524-1.631.956-2.006-3.338-.375-6.826-1.669-6.826-7.406 0-1.632.582-2.982 1.538-4.032-.15-.375-.675-1.912.15-3.975 0 0 1.256-.394 4.125 1.538 1.2-.338 2.475-.506 3.75-.506s2.55.168 3.75.506c2.869-1.95 4.125-1.538 4.125-1.538.825 2.063.3 3.6.15 3.975.956 1.05 1.538 2.382 1.538 4.032 0 5.756-3.507 7.03-6.844 7.406.544.468 1.012 1.369 1.012 2.775 0 2.006-.018 3.619-.018 4.125 0 .394.28.862 1.03.712A15.024 15.024 0 0 0 30.003 15c0-8.287-6.713-15-15-15Z"></path></svg><svg width="32" height="26" viewBox="0 0 32 26" fill="none" xmlns="http://www.w3.org/2000/svg" class="item_KKoc" cursor="pointer"><path d="M31.319 3.484c-1.145.507-2.36.84-3.603.987a6.293 6.293 0 0 0 2.758-3.47 12.518 12.518 0 0 1-3.983 1.52A6.274 6.274 0 0 0 15.64 6.815c0 .493.056.97.161 1.43a17.811 17.811 0 0 1-12.93-6.555 6.252 6.252 0 0 0-.85 3.154 6.272 6.272 0 0 0 2.791 5.222 6.253 6.253 0 0 1-2.841-.785l-.001.077a6.277 6.277 0 0 0 5.033 6.153 6.305 6.305 0 0 1-2.834.108 6.278 6.278 0 0 0 5.86 4.356 12.59 12.59 0 0 1-7.79 2.686c-.5 0-1-.03-1.497-.088a17.746 17.746 0 0 0 9.616 2.818c11.54 0 17.849-9.559 17.849-17.848 0-.272-.007-.544-.019-.812a12.746 12.746 0 0 0 3.13-3.246Z"></path></svg><svg width="30" height="24" viewBox="0 0 30 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="item_KKoc" cursor="pointer"><path d="M15.366 0c.801.004 2.805.024 4.935.11l.755.032c2.145.102 4.287.275 5.35.571 1.417.398 2.53 1.56 2.907 3.033.6 2.339.675 6.903.684 8.008l.002.229v.032l-.002.229c-.009 1.104-.084 5.669-.684 8.008-.381 1.478-1.495 2.64-2.907 3.032-1.063.297-3.205.47-5.35.571l-.755.033c-2.13.086-4.134.105-4.935.11h-.734c-1.696-.01-8.785-.087-11.04-.714-1.418-.398-2.532-1.56-2.908-3.032-.6-2.34-.675-6.904-.684-8.008v-.49c.01-1.105.084-5.67.684-8.008.382-1.478 1.496-2.64 2.908-3.033C5.847.086 12.936.01 14.632 0h.734Zm-3.367 6.749v10.5l9-5.25-9-5.25Z"></path></svg><svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg" class="item_KKoc" cursor="pointer"><path d="M6.791 18.77a2.959 2.959 0 0 1-2.952 2.952 2.959 2.959 0 0 1-2.951-2.951 2.959 2.959 0 0 1 2.951-2.952h2.952v2.952Zm1.487 0a2.959 2.959 0 0 1 2.952-2.951 2.959 2.959 0 0 1 2.952 2.952v7.39a2.959 2.959 0 0 1-2.952 2.952 2.959 2.959 0 0 1-2.952-2.952v-7.39ZM11.23 6.792A2.959 2.959 0 0 1 8.278 3.84 2.959 2.959 0 0 1 11.23.888a2.959 2.959 0 0 1 2.952 2.951v2.952H11.23Zm0 1.487a2.959 2.959 0 0 1 2.952 2.952 2.959 2.959 0 0 1-2.952 2.952H3.84A2.959 2.959 0 0 1 .887 11.23a2.959 2.959 0 0 1 2.951-2.952h7.391Zm11.98 2.952a2.959 2.959 0 0 1 2.951-2.952 2.959 2.959 0 0 1 2.952 2.952 2.959 2.959 0 0 1-2.952 2.952H23.21V11.23Zm-1.488 0a2.959 2.959 0 0 1-2.951 2.952 2.959 2.959 0 0 1-2.952-2.952V3.84A2.959 2.959 0 0 1 18.771.887a2.959 2.959 0 0 1 2.951 2.951v7.391Zm-2.951 11.98a2.959 2.959 0 0 1 2.951 2.951 2.959 2.959 0 0 1-2.951 2.952 2.959 2.959 0 0 1-2.952-2.952V23.21h2.952Zm0-1.488a2.959 2.959 0 0 1-2.952-2.951 2.959 2.959 0 0 1 2.952-2.952h7.39a2.959 2.959 0 0 1 2.952 2.952 2.959 2.959 0 0 1-2.952 2.951h-7.39Z"></path></svg><svg width="28" height="30" viewBox="0 0 28 30" fill="none" xmlns="http://www.w3.org/2000/svg" class="item_KKoc" cursor="pointer"><path d="M22.48 4.286H5.195c-.845 0-1.52.724-1.52 1.568v18.579c0 .844.675 1.568 1.52 1.568h17.283c.845 0 1.52-.724 1.52-1.568V5.854c0-.844-.675-1.568-1.52-1.568Z"></path><path d="M6.233 12.156h3.081v10.756H6.233V12.156Zm1.57-5.315c.988 0 1.802.875 1.802 1.938s-.814 1.939-1.803 1.939C6.814 10.718 6 9.842 6 8.779c0-1.063.814-1.938 1.802-1.938Zm3.488 5.315h2.965v1.439h.058c.407-.876 1.453-1.751 2.965-1.751 3.14 0 3.721 2.25 3.721 5.127v5.879h-3.081v-5.253c0-1.25 0-2.877-1.628-2.877s-1.86 1.376-1.86 2.752v5.315h-3.082v-10.63h-.058Z" fill="#000"></path></svg><svg width="34" height="28" viewBox="0 0 34 28" fill="none" xmlns="http://www.w3.org/2000/svg" class="item_KKoc" cursor="pointer"><path d="M26.863 16.567c.748 0 1.347-.636 1.347-1.347 0-.748-.599-1.347-1.347-1.347s-1.347.599-1.347 1.347.599 1.347 1.347 1.347Zm-6.639 0c.749 0 1.347-.636 1.347-1.347 0-.748-.598-1.347-1.347-1.347-.748 0-1.346.599-1.346 1.347s.598 1.347 1.346 1.347Zm9.852 7.56a.52.52 0 0 0-.258.553c0 .074 0 .148.036.221.148.627.442 1.622.442 1.66 0 .11.037.184.037.257a.33.33 0 0 1-.331.332c-.074 0-.11-.037-.184-.074l-2.174-1.253c-.147-.074-.331-.147-.516-.147-.11 0-.22 0-.294.037-1.032.294-2.1.442-3.242.442-5.49 0-9.91-3.687-9.91-8.258 0-4.57 4.42-8.257 9.91-8.257 5.489 0 9.91 3.686 9.91 8.257 0 2.47-1.327 4.719-3.427 6.23ZM24.01 8.147a13.662 13.662 0 0 0-.418-.007c-6.262 0-11.41 4.29-11.41 9.757 0 .83.119 1.634.342 2.4h-.133c-1.33 0-2.659-.221-3.877-.553-.111-.037-.222-.037-.333-.037-.221 0-.443.074-.627.185L4.932 21.4a.525.525 0 0 1-.221.074.409.409 0 0 1-.406-.405c0-.11.036-.184.073-.294.037-.037.37-1.251.554-1.987 0-.074.037-.184.037-.258a.834.834 0 0 0-.332-.662C2.089 16.065.5 13.378.5 10.398.501 4.916 5.855.5 12.428.5 18.073.5 22.82 3.753 24.01 8.146Zm-7.73.627c.859 0 1.54-.716 1.54-1.54 0-.858-.681-1.539-1.54-1.539-.86 0-1.54.68-1.54 1.54 0 .859.68 1.54 1.54 1.54Zm-7.89 0c.86 0 1.54-.716 1.54-1.54 0-.858-.68-1.539-1.54-1.539-.859 0-1.539.68-1.539 1.54 0 .859.68 1.54 1.54 1.54Z"></path></svg></div></div></div><div class="copyrightWrap_yPz7"><div class="copyright_AoBa">Copyright © 2023 HashData Technology Limited. or its affiliates. All Rights Reserved.</div></div></div></div>
</body>
</html>